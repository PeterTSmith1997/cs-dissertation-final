\section{Evaluating the Formula}
In this section, the formula, that was discussed in chapter 6, shall be evaluated in order to assess its ability to detect malicious trends in traffic. This thesis shall then go on to evaluate the UI in terms of its functionality, by doing so, the hypotheses raised in the prior chapter shall be evaluated.

Three websites were assessed over a one month period and log file data was collected from each site throughout this period. The data captured from the website logs was taken in late January and early February 2020. It should be noted that two variables were chosen in order to display the data and results in a graphical summary. These represent the risk rating versus the occurrences of the IP. The risk rating is an obvious choice for a variable due to the fact that it is the key focus of the software and the proving factor for the majority of the hypothesis. The occurrences were chosen as the second variable due to the fact that they were the aspect that were given the highest weight rating in terms of risk. If the researcher were to look at the requests and responses, they would need to log every occurrence of each response code, which would be difficult to display in the form of a graph.



After looking at the graphical display of data, as it can be seen in Appendix 
\ref{Graph data}, it was clear that a trend exists between extreme levels of occurrences and a higher risk rating. Six out of nine IP addresses with occurrence counts of over 1000, fall within the highest 0.3\% of risk ratings. It should be noted that a huge number of IP addresses seem to fall into the categorisation of low risk rating. 99.45\% of readings fall into the banding of a risk rating of less than 10. For the purposes of testing, in order to analyse the formula in detail, the 10\% from the database that would normally contribute to the score was ignored, therefore if an IP got 100\% in testing then this would equate to 90\% overall.

In order to evaluate the elements of these results it was decided to take some of the IP instances with the highest risk related factors and attempt to diagnose them as malicious or genuine. The decision was also made to look at some of the more anomalous readings, particularly those that fall far outside of the 'trend-line'. These values tend to be those with particularly high occurrence ratings and yet with low risk factor readings, or those with large risk factor ratings and particularly low occurrence ratings. The architecture of these traffic occurrences shall be evaluated individually in order to make conclusions regarding whether or not they display any signs of being a malicious entity.

\subsection{Detailed look at IPs }
In order to further assess the capabilities of the formula. Seven IPs shall now be cross referenced with the data held on abuseipdb. As discussed, these IP's were those displaying the highest risk rating score, and also those falling far from the 'trend-line' on the data set. It is anticipated that this will show the ability of the formula in detecting true attacks.

\subsection*{194.61.24.46}

This IP address originated from the Netherlands. After corresponding with the abuseipdb it was found that this IP has been reported a staggering 1104 times due to malicious trending visits to other websites. After looking deeper into the raw data, it was clear to see that the chains of 403 and 404 responses were patterned in a systematic repeating cycle; thus it is is fair to conclude that this is a malicious entity with bot like features. The software was able to flag this and gave the IP a risk related scoring of 100/100.  

\subsection*{209.124.66.6}

This IP address originated from the UK, this would be a 'best fit' source location to signify a level of inherent trust, due to the UK based websites used in testing. However, when consulting with abuseipdb it becomes apparent that this IP address has been reported for malicious activity 14 times. The formula inferred a risk related rating of 100/100 for this IP source, and the IP was the source of 9134 requests from one particular website within the test window. The responses allocated to the IP GET requests across the test window were made up of chains of 301 and 404 errors. While a 301 response, indicating a redirection for a URL has not been given a risk related factor, in this instance, the continued appearance of these responses are particularly indicative of a potential threat. Along with the 301 responses, a huge string of repeated and systematic 404 errors were returned to the IP source. Altogether it is clear that this IP is the source of malicious traffic, and the formula was correct in applying a maximum risk related flag.

\subsection*{86.175.235.192}

This IP originated in the UK, and it would be appropriate to discuss the features of the IP address and why it may not be malicious. This IP was allocated a risk rating of 100/100, however it is believed that this was a false alert. Firstly this IP has never been reported or raised as a candidate for malicious activity on abuseipdb. The request pattern of the IP address appears to be random in nature, therefore, this does not indicate a bot, as this would be in a systematic pattern. In addition to this, there are a number of 200 response codes, therefore, indicating that some of the requests are legitimate and only some of them are not. An explanation of the pattern may be that the website to which this data belongs was under development; this would generate errors during the testing period. It may therefore be reasonable to predict that this is administration activity. If this is the case it raises a concern regarding the possibility of a false alert being generated by administrators during the building and testing phases of website design. If the rationale that has been adopted to explain this anomaly is correct, it raises the importance of having a human moderator in the detection methodology. Any experienced user would be able to identify their own IP address and de-escalate this false flag.

\subsection*{35.187.118.51}

This IP had the highest number of occurrences within the testing period. Its risk factor hit the maximum score of 100/100. After further study of the data set, it appeared that this IP had made contact with a single website an astonishing 800 times per day, during the period of data collection. After cross referencing with abuseipdb it was found that this IP had previously been reported as a source of malicious activity. The source of the IP was identified as the USA, therefore has a risk related country of origin factor. The raw data within the log files shows a huge string of repeated 403 response codes. This is indicative of malicious activity due to repeated, bot like, attempts to access forbidden pages. It is therefore concluded that this is almost certainly a malicious IP due to the repetition of unauthorised attempts. It is clear that the software was correct in its assessment that this was a high risk candidate.
\subsection{Anomalies in the Data}
\subsection*{192.173.3.114} 

This IP was randomly chosen to be marked as a BOT with the name of "Test"; this was done in order to check whether or not this feature of the software to detect known bots worked efficiently. This IP was marked with a risk factor of 0/100 which supports the conclusion that the software has the ability to detect functional benign bots. When looking on AbuseIPDB, it would appear that this IP address belongs to the University of Northumbria. Therefore, in response to the purpose of testing, it was able to show the ability of the software to detect bots that are known and flagged as such on the database.

\subsection*{108.162.220.175}

This IP originated from the USA. It was allocated a risk score of 6.46/100 through the formula, yet had a particularly large number of occurrences during the data capture. After exploring the raw data it appears that this is an unflagged bot for a service that monitors the 'up-times' of websites. The GET requests generated a multitude of 200 responses which as discussed in prior chapters help to diminish risk related scoring. If flagged properly as a 'good bot', this IP would have been given a risk score of zero. The instance clearly illustrates that particularly high numbers of IP requests within a time frame do not always lead to a high risk related flag. 'Good' or 'genuine' behaviour is credited through the software and leads to a low risk rating despite the weight of the request instances. The software concluded that this IP was a low risk visitor.

\subsection*{63.143.42.250}

This particular IP originated in the USA. At the time of testing the database held on Abuseipdb it was found to have been reported 14 times previously for malicious trending activity. This IP made contact with one particular website during the testing capture 1173 times. After opening the raw Data, it became apparent that this source was a another genuine bot for an 'up-time' website. After looking deeper into the reports on the Abuseipdb website it would appear that the reports were automatically generated by the sites via automated code parameters. Due to the chains of 200 responses a suitably low risk factor rating was issued by the software for this IP, scoring 5/100. This particular log file was instrumental in showcasing the ability of the software to down rate a previously unlisted 'good bot'. Once again, this scenario also shows the usefulness of a human moderator within the detection methodology. The ability of a moderator to use context and rationale within Abuseipdb helped to assess the benign nature of this bot-like activity.

\subsection{Summary}

It is clear from the evaluation of the formula that it is working correctly. Although some false alerts were generated, these cases were identified in essence by the researcher. This action simulates the comparable actions that a potential human moderator could take as the overall system for identification of threats had intended.
%MUST CHECK IF WE NOTED THAT WE HAVE SPOKEN ABOUT THE  10% PART OF THE FORMULA BEING TREAT AS 10/10 FOR THREAT LEVEL DURING TESTING.