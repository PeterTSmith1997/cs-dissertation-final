\subsection{Attack Detection Techniques}

Due to the generalised mechanics of the different types of scanning attacks that have been revealed in the previous section, port scanning should be relatively easy to detect in most cases. Unlike low bandwidth attacks, there is a long history of detailed detection methods for port scanning. The evolution of these techniques will be discussed in the review of the following literature.

\subsection{Snort}

An early port scanning detection technique was Snort. It was created as an open source network intrusion detection based on Libpcap. The detector, used in Staniford's work, attempts to look for (x) TCP or UDP packets sent to any number of ports from a single source in (Y) seconds and assesses the behaviours of this activity for notable malicious scanning characteristics (\cite{staniford2002practical}). The Snort program also looks for single TCP packets that are not used in genuine TCP operations which may have unusual TCP flag settings or no flags set at all. There are several drawbacks of this program. Firstly it is unable to detect scans coming from multiple hosts. The second weakness is that the threshold is determined  and evaluated by using a static combination of user specific data; this method is easy to deceive due to the fact that the Y value has to be set high enough so that there are very few false positives. Therefore, incoming attacks can avoid detection relatively easily, if the attacker increases the time between each successive packet.

A study conducted by \citeauthor{laroche2009evolving} in \citeyear{laroche2009evolving}, attempted to create a stealthy scanning approach to test the limitations of the Snort detection program. A mimicry model was created using a type of computer learning defined as Genetic Programming (GP). Stealthy portscan models were generated and launched with valid attributes (i.e valid TCP/IP packets). The researchers demonstrated that they successfully applied Genetic programming and produced a stealthy mechanism of port scanning that was able to fool the Snort system (\cite{laroche2009evolving}). This research shows that snort was not a reliable way of detecting portscan attacks due to the evolving techniques that can be implemented by attackers, however, Staniford in his 2002 paper proposed a second technique called Spice.
 
\subsection{Spice}
 
Spice is made up of two parts, an anomaly sensor and a correlator component. The researchers noted that saving information about packets would have a detrimental effect on performance, hence they took the approach of storing the details of more likely candidates for malicious activity for longer. The anomaly sensor looked at the suspicious features of the following; header fields, source IP, destination IP, source port, destination port, protocol and protocol flags. The researchers used a Bayesian Network statistical approach to assess the probability of anomalous entries in order to score events in their likelihood of being malicious port scan attacks. Finally, a heuristic analysis is carried out as part of the correlation process where the data is evaluated. It was noted by the research team that a limitation of the Spice detection method is that port scanning attacks that are similar in nature to normal traffic could bypass the anomaly detector. Thus, resulting in a stealthy scan attack not being identified as a threat(\cite{staniford2002practical}); this in turn makes Spice a fundamentally flawed detection method due to the evolving nature of port scan attacks, and the stealth scans discussed in the prior section.


\subsection{Stealth Attacks}

\citeauthor{kim2008slow} defined stealth scans as a technique that avoided Intrusion detection and prevention systems. Intrusion detection systems are detection and monitoring tools that don't take action on their own. They also suggest that stealth methodology has evolved into the setting of flags and the interval between scans in order to appear as normal traffic (\cite{kim2008slow}). The researchers went on to propose a novel detection method using fuzzy logic in order to categorise the architecture and periodicity of incoming port traffic into 3 distinct classifications; this was done by establishing a scoring system in an effort to indicate the potential of each request as being a malicious scan attack. The researchers went on to propose a managing mechanism in order to filter the 3 traffic types in terms of bandwidth allowance using 'stepwise strategies'. It should be noted that in their approaches the authors suggested some drawbacks with this methodology, appreciating that there is no standard of judgement about slow port scan attacks, and there is always a degree of uncertainty while using this technique to detect slow port scans.

All of the research within the field of port scanning is particularly similar in nature, this may be due to the common feature nature of port scan attacks in general. Whether via a heuristic analysis, or even the artificial intelligence methodologies discussed, a degree of uncertainty remains with each system which poses a risk for error in identification. The fact remains that at least some genuine traffic will be blocked due to the 'generalised property rules' that are applied at the managing stage of each system. The papers suggest that there is need for a human factor in judgement within the filtering process, in order to effect confidence in blocking features. In conclusion, although the mitigation techniques presented in this section are impressive and enlightening, they should perhaps be implemented in an advisory capacity rather than as an exclusive method of detection and mitigation.
